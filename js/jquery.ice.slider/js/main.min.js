function IceSlider($,conf){var defconf={selector:'.ice-slider',gotime:500,slitime:3000,autoHeight:false,height:0.6,success:null};conf=$.extend(defconf,conf);var html_footer_main='<div class="j-footer">{content}</div><div class="j-shadow"></div>';var html_footer='<span></span>';$(conf.selector).each(function(){var $_this=$(this);var _domThis=$_this.get(0);var $main=$_this.find('.j-main:eq(0)');var $footer=$_this.find('.j-footer:eq(0)');var $content=$main.find('.j-content');var contentLen=$content.length;var $imgs=$main.find('.j-img');var chooseValue=0;var timer=null;if($main.length==0||contentLen==0){$_this.remove();return};setValue($main);$content.eq(0).css('left','0%');autoHeight($_this,$imgs);var htimer=setInterval(function(){autoHeight($_this,$imgs);if($_this.css('height')>0){clearInterval(htimer)}},200);if(contentLen==1){return};if(conf.autoHeight){$(window).resize(function(){autoHeight($_this,$imgs)})};var $footer=buildFooter($_this,$content.length);var $footspans=$footer.find('span');$footspans.each(function(index){$(this).on('click',function(){if(index==chooseValue)return;clearInterval(timer);var isNext=index>chooseValue;var $_now=$content.eq(index);var $_old=$content.eq(chooseValue);$_now.css('left',isNext?'100%':'-100%');$_old.animate({'left':isNext?'-100%':'100%'},conf.gotime);$_now.animate({'left':'-0%'},conf.gotime);chooseValue=index;$footer.find('span.j-choose').removeClass('j-choose');$(this).addClass('j-choose');autoGo()})});if('ontouchend'in document){var isFin=true;var isMove=false;var startPageX=0;var endPageX=0;var startPageY=0;var endPageY=0;var startTouch,moveTouch,endTouch;_domThis.ontouchstart=function(event){if(isFin){clearInterval(timer);isMove=false;startTouch=event.targetTouches[0];startPageX=startTouch.pageX;startPageY=startTouch.pageY}};_domThis.ontouchmove=function(event){if(isFin){if(event.targetTouches.length>1||event.scale&&event.scale!==1)return;moveTouch=event.targetTouches[0];var moveWidth=startPageX-moveTouch.pageX;var moveHeight=startPageY-moveTouch.pageY;if(Math.abs(moveWidth)>Math.abs(moveHeight)){isMove=true;event.preventDefault()}moveTouch=event.targetTouches[0];endPageX=moveTouch.pageX}};_domThis.ontouchend=function(event){try{if(isFin&&isMove){isFin=false;endTouch=event.targetTouches[0];var _move=endPageX-startPageX;if(_move>0&&chooseValue>0){$footspans.eq((chooseValue+contentLen-1)%contentLen).click()}else if(_move<0&&chooseValue<contentLen-1){$footspans.eq((chooseValue+1)%contentLen).click()}}}catch(e){};isFin=true;autoGo()}};autoGo();function autoGo(){if(timer!=null){clearInterval(timer);timer=null};timer=setInterval(function(){$footspans.eq((chooseValue+1)%contentLen).click()},conf.slitime)}});if(conf.success){conf.success()};function setValue($main,val){$main.attr('choose',val==undefined?'0':val)};function buildFooter($slider,len){var _html='';for(var i=0;i<len;i++){_html+=html_footer};var $_html=$(html_footer_main.replace('{content}',_html));$_html.find('span:eq(0)').addClass('j-choose');$slider.append($_html);$slider.find('.j-shadow').css('opacity',0.5);return $_html};function autoHeight($slider,$imgs){var _h=$imgs.eq(0).css('height');$slider.css('height',_h)}};